[build]
builder = "NIXPACKS"

[services.agentic-layer]
name = "agentic-layer"
root = "."
build_command = "npm install && npm run build"
start_command = "npm run preview -- --host 0.0.0.0 --port $PORT"
healthcheck_path = "/"
# Required Environment Variables for Dashboard
# These must be set via CLI or Railway Dashboard
# VITE_SUPABASE_URL, VITE_SUPABASE_ANON_KEY

[services.omni-node-template]
name = "omni-node-template"
root = "omni-node/"
# Railway automatically detects the Dockerfile in the root folder
# Note: This service is for templating. The Dispatcher clones this configuration.
# We set this to 0 replicas manually in the Railway UI after the initial build to save credits.
restart_policy_max_retries = 10
restart_policy_on_failure = true

[deploy]
# Ensure the dashboard is permanently running
num_replicas = 1
sleep_on_idle = false